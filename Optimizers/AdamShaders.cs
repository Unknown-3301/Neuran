using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
namespace Neuran.Optimizers
{
    internal static class AdamShaders
    {
        /*
        #pragma kernel CSMain

        RWStructuredBuffer<float> Parameters : register(u0);
        RWStructuredBuffer<float> Derivatives : register(u1);
        RWStructuredBuffer<float> Moment1 : register(u2);
        RWStructuredBuffer<float> Moment2 : register(u3);

        cbuffer Info : register(b0)
        {
            float Beta1;
            float Beta2;
            float Beta1T;
            float Beta2T;
    
            int Length;
    
            int dummy1;
            int dummy2;
            float LearningRate;
        }

        [numthreads(16, 1, 1)]
        void CSMain(uint3 id : SV_DispatchThreadID)
        {
            if (id.x >= Length)
            {
                return;
            }
    
            float g = Derivatives[id.x];
            float m = Moment1[id.x];
            float u = Moment2[id.x];
    
            m = m * Beta1 + (1 - Beta1) * g;
            u = u * Beta2 + (1 - Beta2) * g * g;
    
            Moment1[id.x] = m;
            Moment2[id.x] = u;
    
            float md = m / (1 - Beta1T);
            float ud = u / (1 - Beta2T);
    
            float v = Parameters[id.x];
            Parameters[id.x] = v - LearningRate * md / (sqrt(ud) + 0.0000001);
        }*/
        public static byte[] Adam1 = new byte[]
        { 
        68, 88, 66, 67, 186, 191, 141, 40, 120, 28, 73, 109, 103, 184, 92, 67, 70, 117, 122, 248, 1, 0, 0, 0
                    , 116, 8, 0, 0, 5, 0, 0, 0, 52, 0, 0, 0, 132, 4, 0, 0, 148, 4, 0, 0, 164, 4, 0
                    , 0, 216, 7, 0, 0, 82, 68, 69, 70, 72, 4, 0, 0, 5, 0, 0, 0, 8, 1, 0, 0, 5, 0
                    , 0, 0, 60, 0, 0, 0, 0, 5, 83, 67, 0, 1, 0, 0, 32, 4, 0, 0, 82, 68, 49, 49, 60
                    , 0, 0, 0, 24, 0, 0, 0, 32, 0, 0, 0, 40, 0, 0, 0, 36, 0, 0, 0, 12, 0, 0, 0
                    , 0, 0, 0, 0, 220, 0, 0, 0, 6, 0, 0, 0, 6, 0, 0, 0, 1, 0, 0, 0, 4, 0, 0
                    , 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 231, 0, 0, 0, 6, 0, 0, 0, 6, 0
                    , 0, 0, 1, 0, 0, 0, 4, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 243
                    , 0, 0, 0, 6, 0, 0, 0, 6, 0, 0, 0, 1, 0, 0, 0, 4, 0, 0, 0, 2, 0, 0, 0
                    , 1, 0, 0, 0, 1, 0, 0, 0, 251, 0, 0, 0, 6, 0, 0, 0, 6, 0, 0, 0, 1, 0, 0
                    , 0, 4, 0, 0, 0, 3, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 3, 1, 0, 0, 0, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1
                    , 0, 0, 0, 80, 97, 114, 97, 109, 101, 116, 101, 114, 115, 0, 68, 101, 114, 105, 118, 97, 116, 105, 118
                    , 101, 115, 0, 77, 111, 109, 101, 110, 116, 49, 0, 77, 111, 109, 101, 110, 116, 50, 0, 73, 110, 102, 111
                    , 0, 3, 1, 0, 0, 8, 0, 0, 0, 128, 1, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    , 0, 0, 220, 0, 0, 0, 1, 0, 0, 0, 80, 3, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 3
                    , 0, 0, 0, 231, 0, 0, 0, 1, 0, 0, 0, 168, 3, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0
                    , 3, 0, 0, 0, 243, 0, 0, 0, 1, 0, 0, 0, 208, 3, 0, 0, 4, 0, 0, 0, 0, 0, 0
                    , 0, 3, 0, 0, 0, 251, 0, 0, 0, 1, 0, 0, 0, 248, 3, 0, 0, 4, 0, 0, 0, 0, 0
                    , 0, 0, 3, 0, 0, 0, 192, 2, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 2, 0, 0, 0, 204
                    , 2, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0
                    , 240, 2, 0, 0, 4, 0, 0, 0, 4, 0, 0, 0, 2, 0, 0, 0, 204, 2, 0, 0, 0, 0, 0
                    , 0, 255, 255, 255, 255, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 246, 2, 0, 0, 8, 0
                    , 0, 0, 4, 0, 0, 0, 2, 0, 0, 0, 204, 2, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0
                    , 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 253, 2, 0, 0, 12, 0, 0, 0, 4, 0, 0, 0
                    , 2, 0, 0, 0, 204, 2, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 255, 255, 255
                    , 255, 0, 0, 0, 0, 4, 3, 0, 0, 16, 0, 0, 0, 4, 0, 0, 0, 2, 0, 0, 0, 16, 3
                    , 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 52
                    , 3, 0, 0, 20, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 16, 3, 0, 0, 0, 0, 0, 0
                    , 255, 255, 255, 255, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 59, 3, 0, 0, 24, 0, 0
                    , 0, 4, 0, 0, 0, 0, 0, 0, 0, 16, 3, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0
                    , 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 66, 3, 0, 0, 28, 0, 0, 0, 4, 0, 0, 0, 2
                    , 0, 0, 0, 204, 2, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 255, 255, 255, 255
                    , 0, 0, 0, 0, 66, 101, 116, 97, 49, 0, 102, 108, 111, 97, 116, 0, 0, 0, 3, 0, 1, 0, 1
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    , 0, 0, 198, 2, 0, 0, 66, 101, 116, 97, 50, 0, 66, 101, 116, 97, 49, 84, 0, 66, 101, 116, 97
                    , 50, 84, 0, 76, 101, 110, 103, 116, 104, 0, 105, 110, 116, 0, 171, 0, 0, 2, 0, 1, 0, 1, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    , 0, 11, 3, 0, 0, 100, 117, 109, 109, 121, 49, 0, 100, 117, 109, 109, 121, 50, 0, 76, 101, 97, 114
                    , 110, 105, 110, 103, 82, 97, 116, 101, 0, 171, 120, 3, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 2
                    , 0, 0, 0, 132, 3, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 255, 255, 255, 255
                    , 0, 0, 0, 0, 36, 69, 108, 101, 109, 101, 110, 116, 0, 171, 171, 171, 0, 0, 3, 0, 1, 0, 1
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    , 0, 0, 198, 2, 0, 0, 120, 3, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 2, 0, 0, 0, 132
                    , 3, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0
                    , 120, 3, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 2, 0, 0, 0, 132, 3, 0, 0, 0, 0, 0
                    , 0, 255, 255, 255, 255, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 120, 3, 0, 0, 0, 0
                    , 0, 0, 4, 0, 0, 0, 2, 0, 0, 0, 132, 3, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0
                    , 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 77, 105, 99, 114, 111, 115, 111, 102, 116, 32, 40, 82
                    , 41, 32, 72, 76, 83, 76, 32, 83, 104, 97, 100, 101, 114, 32, 67, 111, 109, 112, 105, 108, 101, 114, 32
                    , 49, 48, 46, 49, 0, 73, 83, 71, 78, 8, 0, 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, 79, 83
                    , 71, 78, 8, 0, 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, 83, 72, 69, 88, 44, 3, 0, 0, 80
                    , 0, 5, 0, 203, 0, 0, 0, 106, 8, 0, 1, 89, 0, 0, 4, 70, 142, 32, 0, 0, 0, 0, 0
                    , 2, 0, 0, 0, 158, 0, 0, 4, 0, 224, 17, 0, 0, 0, 0, 0, 4, 0, 0, 0, 158, 0, 0
                    , 4, 0, 224, 17, 0, 1, 0, 0, 0, 4, 0, 0, 0, 158, 0, 0, 4, 0, 224, 17, 0, 2, 0
                    , 0, 0, 4, 0, 0, 0, 158, 0, 0, 4, 0, 224, 17, 0, 3, 0, 0, 0, 4, 0, 0, 0, 95
                    , 0, 0, 2, 18, 0, 2, 0, 104, 0, 0, 2, 2, 0, 0, 0, 155, 0, 0, 4, 16, 0, 0, 0
                    , 1, 0, 0, 0, 1, 0, 0, 0, 80, 0, 0, 7, 18, 0, 16, 0, 0, 0, 0, 0, 10, 0, 2
                    , 0, 10, 128, 32, 0, 0, 0, 0, 0, 1, 0, 0, 0, 31, 0, 4, 3, 10, 0, 16, 0, 0, 0
                    , 0, 0, 62, 0, 0, 1, 21, 0, 0, 1, 167, 0, 0, 138, 2, 35, 0, 128, 131, 153, 25, 0, 18
                    , 0, 16, 0, 0, 0, 0, 0, 10, 0, 2, 0, 1, 64, 0, 0, 0, 0, 0, 0, 6, 224, 17, 0
                    , 1, 0, 0, 0, 167, 0, 0, 138, 2, 35, 0, 128, 131, 153, 25, 0, 34, 0, 16, 0, 0, 0, 0
                    , 0, 10, 0, 2, 0, 1, 64, 0, 0, 0, 0, 0, 0, 6, 224, 17, 0, 2, 0, 0, 0, 167, 0
                    , 0, 138, 2, 35, 0, 128, 131, 153, 25, 0, 66, 0, 16, 0, 0, 0, 0, 0, 10, 0, 2, 0, 1
                    , 64, 0, 0, 0, 0, 0, 0, 6, 224, 17, 0, 3, 0, 0, 0, 0, 0, 0, 12, 242, 0, 16, 0
                    , 1, 0, 0, 0, 70, 142, 32, 128, 65, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 64, 0
                    , 0, 0, 0, 128, 63, 0, 0, 128, 63, 0, 0, 128, 63, 0, 0, 128, 63, 56, 0, 0, 7, 130, 0
                    , 16, 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0, 0, 10, 0, 16, 0, 1, 0, 0, 0, 50
                    , 0, 0, 10, 34, 0, 16, 0, 0, 0, 0, 0, 26, 0, 16, 0, 0, 0, 0, 0, 10, 128, 32, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 58, 0, 16, 0, 0, 0, 0, 0, 56, 0, 0, 7, 18, 0, 16
                    , 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0, 0, 56, 0
                    , 0, 7, 18, 0, 16, 0, 0, 0, 0, 0, 26, 0, 16, 0, 1, 0, 0, 0, 10, 0, 16, 0, 0
                    , 0, 0, 0, 50, 0, 0, 10, 18, 0, 16, 0, 0, 0, 0, 0, 42, 0, 16, 0, 0, 0, 0, 0
                    , 26, 128, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0, 0, 168, 0, 0
                    , 8, 18, 224, 17, 0, 2, 0, 0, 0, 10, 0, 2, 0, 1, 64, 0, 0, 0, 0, 0, 0, 26, 0
                    , 16, 0, 0, 0, 0, 0, 168, 0, 0, 8, 18, 224, 17, 0, 3, 0, 0, 0, 10, 0, 2, 0, 1
                    , 64, 0, 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0, 0, 14, 0, 0, 7, 50, 0, 16, 0
                    , 0, 0, 0, 0, 70, 0, 16, 0, 0, 0, 0, 0, 182, 15, 16, 0, 1, 0, 0, 0, 167, 0, 0
                    , 138, 2, 35, 0, 128, 131, 153, 25, 0, 66, 0, 16, 0, 0, 0, 0, 0, 10, 0, 2, 0, 1, 64
                    , 0, 0, 0, 0, 0, 0, 6, 224, 17, 0, 0, 0, 0, 0, 56, 0, 0, 8, 34, 0, 16, 0, 0
                    , 0, 0, 0, 26, 0, 16, 0, 0, 0, 0, 0, 58, 128, 32, 0, 0, 0, 0, 0, 1, 0, 0, 0
                    , 75, 0, 0, 5, 18, 0, 16, 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0, 0, 0, 0, 0
                    , 7, 18, 0, 16, 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0, 0, 1, 64, 0, 0, 149, 191
                    , 214, 51, 14, 0, 0, 7, 18, 0, 16, 0, 0, 0, 0, 0, 26, 0, 16, 0, 0, 0, 0, 0, 10
                    , 0, 16, 0, 0, 0, 0, 0, 0, 0, 0, 8, 18, 0, 16, 0, 0, 0, 0, 0, 10, 0, 16, 128
                    , 65, 0, 0, 0, 0, 0, 0, 0, 42, 0, 16, 0, 0, 0, 0, 0, 168, 0, 0, 8, 18, 224, 17
                    , 0, 0, 0, 0, 0, 10, 0, 2, 0, 1, 64, 0, 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0
                    , 0, 0, 62, 0, 0, 1, 83, 84, 65, 84, 148, 0, 0, 0, 24, 0, 0, 0, 2, 0, 0, 0, 0
                    , 0, 0, 0, 1, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0
                    , 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    , 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0
                    , 0, };
        /*
        #pragma kernel CSMain

        RWTexture2D<float> Parameters : register(u0);
        RWTexture2D<float> Derivatives : register(u1);
        RWTexture2D<float> Moment1 : register(u2);
        RWTexture2D<float> Moment2 : register(u3);

        cbuffer Info : register(b0)
        {
            float Beta1;
            float Beta2;
            float Beta1T;
            float Beta2T;
    
            int Width;
            int Height;
    
            int dummy2;
            float LearningRate;
        }

        [numthreads(8, 8, 1)]
        void CSMain(uint3 id : SV_DispatchThreadID)
        {
            if (id.x >= Width || id.y >= Height)
            {
                return;
            }
    
            float g = Derivatives[id.xy];
            float m = Moment1[id.xy];
            float u = Moment2[id.xy];
    
            m = m * Beta1 + (1 - Beta1) * g;
            u = u * Beta2 + (1 - Beta2) * g * g;
    
            Moment1[id.xy] = m;
            Moment2[id.xy] = u;
    
            float md = m / (1 - Beta1T);
            float ud = u / (1 - Beta2T);
    
            float v = Parameters[id.xy];
            Parameters[id.xy] = v - LearningRate * md / (sqrt(ud) + 0.0000001);
        }*/
        public static byte[] Adam2 = new byte[]
        { 
        68, 88, 66, 67, 248, 91, 10, 228, 129, 186, 20, 36, 195, 102, 63, 45, 200, 193, 107, 208, 1, 0, 0, 0
                    , 40, 7, 0, 0, 5, 0, 0, 0, 52, 0, 0, 0, 84, 3, 0, 0, 100, 3, 0, 0, 116, 3, 0
                    , 0, 140, 6, 0, 0, 82, 68, 69, 70, 24, 3, 0, 0, 1, 0, 0, 0, 8, 1, 0, 0, 5, 0
                    , 0, 0, 60, 0, 0, 0, 0, 5, 83, 67, 0, 1, 0, 0, 239, 2, 0, 0, 82, 68, 49, 49, 60
                    , 0, 0, 0, 24, 0, 0, 0, 32, 0, 0, 0, 40, 0, 0, 0, 36, 0, 0, 0, 12, 0, 0, 0
                    , 0, 0, 0, 0, 220, 0, 0, 0, 4, 0, 0, 0, 5, 0, 0, 0, 4, 0, 0, 0, 255, 255, 255
                    , 255, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 231, 0, 0, 0, 4, 0, 0, 0, 5, 0
                    , 0, 0, 4, 0, 0, 0, 255, 255, 255, 255, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 243
                    , 0, 0, 0, 4, 0, 0, 0, 5, 0, 0, 0, 4, 0, 0, 0, 255, 255, 255, 255, 2, 0, 0, 0
                    , 1, 0, 0, 0, 1, 0, 0, 0, 251, 0, 0, 0, 4, 0, 0, 0, 5, 0, 0, 0, 4, 0, 0
                    , 0, 255, 255, 255, 255, 3, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 3, 1, 0, 0, 0, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1
                    , 0, 0, 0, 80, 97, 114, 97, 109, 101, 116, 101, 114, 115, 0, 68, 101, 114, 105, 118, 97, 116, 105, 118
                    , 101, 115, 0, 77, 111, 109, 101, 110, 116, 49, 0, 77, 111, 109, 101, 110, 116, 50, 0, 73, 110, 102, 111
                    , 0, 3, 1, 0, 0, 8, 0, 0, 0, 32, 1, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    , 0, 0, 96, 2, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 2, 0, 0, 0, 108, 2, 0, 0, 0
                    , 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 144, 2, 0, 0
                    , 4, 0, 0, 0, 4, 0, 0, 0, 2, 0, 0, 0, 108, 2, 0, 0, 0, 0, 0, 0, 255, 255, 255
                    , 255, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 150, 2, 0, 0, 8, 0, 0, 0, 4, 0
                    , 0, 0, 2, 0, 0, 0, 108, 2, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 255
                    , 255, 255, 255, 0, 0, 0, 0, 157, 2, 0, 0, 12, 0, 0, 0, 4, 0, 0, 0, 2, 0, 0, 0
                    , 108, 2, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0
                    , 0, 164, 2, 0, 0, 16, 0, 0, 0, 4, 0, 0, 0, 2, 0, 0, 0, 176, 2, 0, 0, 0, 0
                    , 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 212, 2, 0, 0, 20
                    , 0, 0, 0, 4, 0, 0, 0, 2, 0, 0, 0, 176, 2, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255
                    , 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 219, 2, 0, 0, 24, 0, 0, 0, 4, 0, 0
                    , 0, 0, 0, 0, 0, 176, 2, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 255, 255
                    , 255, 255, 0, 0, 0, 0, 226, 2, 0, 0, 28, 0, 0, 0, 4, 0, 0, 0, 2, 0, 0, 0, 108
                    , 2, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0
                    , 66, 101, 116, 97, 49, 0, 102, 108, 111, 97, 116, 0, 0, 0, 3, 0, 1, 0, 1, 0, 0, 0, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 102, 2
                    , 0, 0, 66, 101, 116, 97, 50, 0, 66, 101, 116, 97, 49, 84, 0, 66, 101, 116, 97, 50, 84, 0, 87
                    , 105, 100, 116, 104, 0, 105, 110, 116, 0, 171, 171, 0, 0, 2, 0, 1, 0, 1, 0, 0, 0, 0, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 170, 2, 0
                    , 0, 72, 101, 105, 103, 104, 116, 0, 100, 117, 109, 109, 121, 50, 0, 76, 101, 97, 114, 110, 105, 110, 103
                    , 82, 97, 116, 101, 0, 77, 105, 99, 114, 111, 115, 111, 102, 116, 32, 40, 82, 41, 32, 72, 76, 83, 76
                    , 32, 83, 104, 97, 100, 101, 114, 32, 67, 111, 109, 112, 105, 108, 101, 114, 32, 49, 48, 46, 49, 0, 171
                    , 73, 83, 71, 78, 8, 0, 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, 79, 83, 71, 78, 8, 0, 0
                    , 0, 0, 0, 0, 0, 8, 0, 0, 0, 83, 72, 69, 88, 16, 3, 0, 0, 80, 0, 5, 0, 196, 0
                    , 0, 0, 106, 8, 0, 1, 89, 0, 0, 4, 70, 142, 32, 0, 0, 0, 0, 0, 2, 0, 0, 0, 156
                    , 24, 0, 4, 0, 224, 17, 0, 0, 0, 0, 0, 85, 85, 0, 0, 156, 24, 0, 4, 0, 224, 17, 0
                    , 1, 0, 0, 0, 85, 85, 0, 0, 156, 24, 0, 4, 0, 224, 17, 0, 2, 0, 0, 0, 85, 85, 0
                    , 0, 156, 24, 0, 4, 0, 224, 17, 0, 3, 0, 0, 0, 85, 85, 0, 0, 95, 0, 0, 2, 50, 0
                    , 2, 0, 104, 0, 0, 2, 2, 0, 0, 0, 155, 0, 0, 4, 8, 0, 0, 0, 8, 0, 0, 0, 1
                    , 0, 0, 0, 80, 0, 0, 7, 50, 0, 16, 0, 0, 0, 0, 0, 70, 0, 2, 0, 70, 128, 32, 0
                    , 0, 0, 0, 0, 1, 0, 0, 0, 60, 0, 0, 7, 18, 0, 16, 0, 0, 0, 0, 0, 26, 0, 16
                    , 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0, 0, 31, 0, 4, 3, 10, 0, 16, 0, 0, 0
                    , 0, 0, 62, 0, 0, 1, 21, 0, 0, 1, 163, 0, 0, 136, 194, 0, 0, 128, 67, 85, 21, 0, 18
                    , 0, 16, 0, 0, 0, 0, 0, 70, 5, 2, 0, 70, 238, 17, 0, 1, 0, 0, 0, 163, 0, 0, 136
                    , 194, 0, 0, 128, 67, 85, 21, 0, 34, 0, 16, 0, 0, 0, 0, 0, 70, 5, 2, 0, 22, 238, 17
                    , 0, 2, 0, 0, 0, 163, 0, 0, 136, 194, 0, 0, 128, 67, 85, 21, 0, 66, 0, 16, 0, 0, 0
                    , 0, 0, 70, 5, 2, 0, 150, 236, 17, 0, 3, 0, 0, 0, 0, 0, 0, 12, 242, 0, 16, 0, 1
                    , 0, 0, 0, 70, 142, 32, 128, 65, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 64, 0, 0
                    , 0, 0, 128, 63, 0, 0, 128, 63, 0, 0, 128, 63, 0, 0, 128, 63, 56, 0, 0, 7, 130, 0, 16
                    , 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0, 0, 10, 0, 16, 0, 1, 0, 0, 0, 50, 0
                    , 0, 10, 34, 0, 16, 0, 0, 0, 0, 0, 26, 0, 16, 0, 0, 0, 0, 0, 10, 128, 32, 0, 0
                    , 0, 0, 0, 0, 0, 0, 0, 58, 0, 16, 0, 0, 0, 0, 0, 56, 0, 0, 7, 18, 0, 16, 0
                    , 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0, 0, 56, 0, 0
                    , 7, 18, 0, 16, 0, 0, 0, 0, 0, 26, 0, 16, 0, 1, 0, 0, 0, 10, 0, 16, 0, 0, 0
                    , 0, 0, 50, 0, 0, 10, 18, 0, 16, 0, 0, 0, 0, 0, 42, 0, 16, 0, 0, 0, 0, 0, 26
                    , 128, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0, 0, 164, 0, 0, 6
                    , 242, 224, 17, 0, 2, 0, 0, 0, 70, 5, 2, 0, 86, 5, 16, 0, 0, 0, 0, 0, 164, 0, 0
                    , 6, 242, 224, 17, 0, 3, 0, 0, 0, 70, 5, 2, 0, 6, 0, 16, 0, 0, 0, 0, 0, 14, 0
                    , 0, 7, 50, 0, 16, 0, 0, 0, 0, 0, 70, 0, 16, 0, 0, 0, 0, 0, 182, 15, 16, 0, 1
                    , 0, 0, 0, 163, 0, 0, 136, 194, 0, 0, 128, 67, 85, 21, 0, 66, 0, 16, 0, 0, 0, 0, 0
                    , 70, 5, 2, 0, 150, 236, 17, 0, 0, 0, 0, 0, 56, 0, 0, 8, 34, 0, 16, 0, 0, 0, 0
                    , 0, 26, 0, 16, 0, 0, 0, 0, 0, 58, 128, 32, 0, 0, 0, 0, 0, 1, 0, 0, 0, 75, 0
                    , 0, 5, 18, 0, 16, 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0, 0, 0, 0, 0, 7, 18
                    , 0, 16, 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0, 0, 1, 64, 0, 0, 149, 191, 214, 51
                    , 14, 0, 0, 7, 18, 0, 16, 0, 0, 0, 0, 0, 26, 0, 16, 0, 0, 0, 0, 0, 10, 0, 16
                    , 0, 0, 0, 0, 0, 0, 0, 0, 8, 18, 0, 16, 0, 0, 0, 0, 0, 10, 0, 16, 128, 65, 0
                    , 0, 0, 0, 0, 0, 0, 42, 0, 16, 0, 0, 0, 0, 0, 164, 0, 0, 6, 242, 224, 17, 0, 0
                    , 0, 0, 0, 70, 5, 2, 0, 6, 0, 16, 0, 0, 0, 0, 0, 62, 0, 0, 1, 83, 84, 65, 84
                    , 148, 0, 0, 0, 25, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 12, 0, 0
                    , 0, 0, 0, 0, 0, 2, 0, 0, 0, 2, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, };
        /*
        #pragma kernel CSMain

        RWTexture3D<float> Parameters : register(u0);
        RWTexture3D<float> Derivatives : register(u1);
        RWTexture3D<float> Moment1 : register(u2);
        RWTexture3D<float> Moment2 : register(u3);

        cbuffer Info : register(b0)
        {
            float Beta1;
            float Beta2;
            float Beta1T;
            float Beta2T;
    
            int Width;
            int Height;
            int Depth;
    
            float LearningRate;
        }

        [numthreads(8, 8, 1)]
                void CSMain(uint3 id : SV_DispatchThreadID)
        {
            if (id.x >= Width || id.y >= Height || id.z >= Depth)
            {
                return;
            }
    
            float g = Derivatives[id];
            float m = Moment1[id];
            float u = Moment2[id];
    
            m = m * Beta1 + (1 - Beta1) * g;
            u = u * Beta2 + (1 - Beta2) * g * g;
    
            Moment1[id] = m;
            Moment2[id] = u;
    
            float md = m / (1 - Beta1T);
            float ud = u / (1 - Beta2T);
    
            float v = Parameters[id];
            Parameters[id] = v - LearningRate * md / (sqrt(ud) + 0.0000001);
        }*/
        public static byte[] Adam3 = new byte[]
        { 
        68, 88, 66, 67, 76, 209, 61, 119, 210, 52, 238, 177, 247, 49, 67, 75, 73, 246, 158, 123, 1, 0, 0, 0
                    , 68, 7, 0, 0, 5, 0, 0, 0, 52, 0, 0, 0, 84, 3, 0, 0, 100, 3, 0, 0, 116, 3, 0
                    , 0, 168, 6, 0, 0, 82, 68, 69, 70, 24, 3, 0, 0, 1, 0, 0, 0, 8, 1, 0, 0, 5, 0
                    , 0, 0, 60, 0, 0, 0, 0, 5, 83, 67, 0, 1, 0, 0, 238, 2, 0, 0, 82, 68, 49, 49, 60
                    , 0, 0, 0, 24, 0, 0, 0, 32, 0, 0, 0, 40, 0, 0, 0, 36, 0, 0, 0, 12, 0, 0, 0
                    , 0, 0, 0, 0, 220, 0, 0, 0, 4, 0, 0, 0, 5, 0, 0, 0, 8, 0, 0, 0, 255, 255, 255
                    , 255, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 231, 0, 0, 0, 4, 0, 0, 0, 5, 0
                    , 0, 0, 8, 0, 0, 0, 255, 255, 255, 255, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 243
                    , 0, 0, 0, 4, 0, 0, 0, 5, 0, 0, 0, 8, 0, 0, 0, 255, 255, 255, 255, 2, 0, 0, 0
                    , 1, 0, 0, 0, 1, 0, 0, 0, 251, 0, 0, 0, 4, 0, 0, 0, 5, 0, 0, 0, 8, 0, 0
                    , 0, 255, 255, 255, 255, 3, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 3, 1, 0, 0, 0, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1
                    , 0, 0, 0, 80, 97, 114, 97, 109, 101, 116, 101, 114, 115, 0, 68, 101, 114, 105, 118, 97, 116, 105, 118
                    , 101, 115, 0, 77, 111, 109, 101, 110, 116, 49, 0, 77, 111, 109, 101, 110, 116, 50, 0, 73, 110, 102, 111
                    , 0, 3, 1, 0, 0, 8, 0, 0, 0, 32, 1, 0, 0, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    , 0, 0, 96, 2, 0, 0, 0, 0, 0, 0, 4, 0, 0, 0, 2, 0, 0, 0, 108, 2, 0, 0, 0
                    , 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 144, 2, 0, 0
                    , 4, 0, 0, 0, 4, 0, 0, 0, 2, 0, 0, 0, 108, 2, 0, 0, 0, 0, 0, 0, 255, 255, 255
                    , 255, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 150, 2, 0, 0, 8, 0, 0, 0, 4, 0
                    , 0, 0, 2, 0, 0, 0, 108, 2, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 255
                    , 255, 255, 255, 0, 0, 0, 0, 157, 2, 0, 0, 12, 0, 0, 0, 4, 0, 0, 0, 2, 0, 0, 0
                    , 108, 2, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0
                    , 0, 164, 2, 0, 0, 16, 0, 0, 0, 4, 0, 0, 0, 2, 0, 0, 0, 176, 2, 0, 0, 0, 0
                    , 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 212, 2, 0, 0, 20
                    , 0, 0, 0, 4, 0, 0, 0, 2, 0, 0, 0, 176, 2, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255
                    , 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 219, 2, 0, 0, 24, 0, 0, 0, 4, 0, 0
                    , 0, 2, 0, 0, 0, 176, 2, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 255, 255
                    , 255, 255, 0, 0, 0, 0, 225, 2, 0, 0, 28, 0, 0, 0, 4, 0, 0, 0, 2, 0, 0, 0, 108
                    , 2, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0, 255, 255, 255, 255, 0, 0, 0, 0
                    , 66, 101, 116, 97, 49, 0, 102, 108, 111, 97, 116, 0, 0, 0, 3, 0, 1, 0, 1, 0, 0, 0, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 102, 2
                    , 0, 0, 66, 101, 116, 97, 50, 0, 66, 101, 116, 97, 49, 84, 0, 66, 101, 116, 97, 50, 84, 0, 87
                    , 105, 100, 116, 104, 0, 105, 110, 116, 0, 171, 171, 0, 0, 2, 0, 1, 0, 1, 0, 0, 0, 0, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 170, 2, 0
                    , 0, 72, 101, 105, 103, 104, 116, 0, 68, 101, 112, 116, 104, 0, 76, 101, 97, 114, 110, 105, 110, 103, 82
                    , 97, 116, 101, 0, 77, 105, 99, 114, 111, 115, 111, 102, 116, 32, 40, 82, 41, 32, 72, 76, 83, 76, 32
                    , 83, 104, 97, 100, 101, 114, 32, 67, 111, 109, 112, 105, 108, 101, 114, 32, 49, 48, 46, 49, 0, 171, 171
                    , 73, 83, 71, 78, 8, 0, 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, 79, 83, 71, 78, 8, 0, 0
                    , 0, 0, 0, 0, 0, 8, 0, 0, 0, 83, 72, 69, 88, 44, 3, 0, 0, 80, 0, 5, 0, 203, 0
                    , 0, 0, 106, 8, 0, 1, 89, 0, 0, 4, 70, 142, 32, 0, 0, 0, 0, 0, 2, 0, 0, 0, 156
                    , 40, 0, 4, 0, 224, 17, 0, 0, 0, 0, 0, 85, 85, 0, 0, 156, 40, 0, 4, 0, 224, 17, 0
                    , 1, 0, 0, 0, 85, 85, 0, 0, 156, 40, 0, 4, 0, 224, 17, 0, 2, 0, 0, 0, 85, 85, 0
                    , 0, 156, 40, 0, 4, 0, 224, 17, 0, 3, 0, 0, 0, 85, 85, 0, 0, 95, 0, 0, 2, 114, 0
                    , 2, 0, 104, 0, 0, 2, 2, 0, 0, 0, 155, 0, 0, 4, 8, 0, 0, 0, 8, 0, 0, 0, 1
                    , 0, 0, 0, 80, 0, 0, 7, 114, 0, 16, 0, 0, 0, 0, 0, 70, 2, 2, 0, 70, 130, 32, 0
                    , 0, 0, 0, 0, 1, 0, 0, 0, 60, 0, 0, 7, 18, 0, 16, 0, 0, 0, 0, 0, 26, 0, 16
                    , 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0, 0, 60, 0, 0, 7, 18, 0, 16, 0, 0, 0
                    , 0, 0, 42, 0, 16, 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0, 0, 31, 0, 4, 3, 10
                    , 0, 16, 0, 0, 0, 0, 0, 62, 0, 0, 1, 21, 0, 0, 1, 163, 0, 0, 136, 66, 1, 0, 128
                    , 67, 85, 21, 0, 18, 0, 16, 0, 0, 0, 0, 0, 70, 10, 2, 0, 70, 238, 17, 0, 1, 0, 0
                    , 0, 163, 0, 0, 136, 66, 1, 0, 128, 67, 85, 21, 0, 34, 0, 16, 0, 0, 0, 0, 0, 70, 10
                    , 2, 0, 22, 238, 17, 0, 2, 0, 0, 0, 163, 0, 0, 136, 66, 1, 0, 128, 67, 85, 21, 0, 66
                    , 0, 16, 0, 0, 0, 0, 0, 70, 10, 2, 0, 150, 236, 17, 0, 3, 0, 0, 0, 0, 0, 0, 12
                    , 242, 0, 16, 0, 1, 0, 0, 0, 70, 142, 32, 128, 65, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    , 0, 2, 64, 0, 0, 0, 0, 128, 63, 0, 0, 128, 63, 0, 0, 128, 63, 0, 0, 128, 63, 56, 0
                    , 0, 7, 130, 0, 16, 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0, 0, 10, 0, 16, 0, 1
                    , 0, 0, 0, 50, 0, 0, 10, 34, 0, 16, 0, 0, 0, 0, 0, 26, 0, 16, 0, 0, 0, 0, 0
                    , 10, 128, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 58, 0, 16, 0, 0, 0, 0, 0, 56, 0, 0
                    , 7, 18, 0, 16, 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0
                    , 0, 0, 56, 0, 0, 7, 18, 0, 16, 0, 0, 0, 0, 0, 26, 0, 16, 0, 1, 0, 0, 0, 10
                    , 0, 16, 0, 0, 0, 0, 0, 50, 0, 0, 10, 18, 0, 16, 0, 0, 0, 0, 0, 42, 0, 16, 0
                    , 0, 0, 0, 0, 26, 128, 32, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0
                    , 0, 164, 0, 0, 6, 242, 224, 17, 0, 2, 0, 0, 0, 70, 10, 2, 0, 86, 5, 16, 0, 0, 0
                    , 0, 0, 164, 0, 0, 6, 242, 224, 17, 0, 3, 0, 0, 0, 70, 10, 2, 0, 6, 0, 16, 0, 0
                    , 0, 0, 0, 14, 0, 0, 7, 50, 0, 16, 0, 0, 0, 0, 0, 70, 0, 16, 0, 0, 0, 0, 0
                    , 182, 15, 16, 0, 1, 0, 0, 0, 163, 0, 0, 136, 66, 1, 0, 128, 67, 85, 21, 0, 66, 0, 16
                    , 0, 0, 0, 0, 0, 70, 10, 2, 0, 150, 236, 17, 0, 0, 0, 0, 0, 56, 0, 0, 8, 34, 0
                    , 16, 0, 0, 0, 0, 0, 26, 0, 16, 0, 0, 0, 0, 0, 58, 128, 32, 0, 0, 0, 0, 0, 1
                    , 0, 0, 0, 75, 0, 0, 5, 18, 0, 16, 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0, 0
                    , 0, 0, 0, 7, 18, 0, 16, 0, 0, 0, 0, 0, 10, 0, 16, 0, 0, 0, 0, 0, 1, 64, 0
                    , 0, 149, 191, 214, 51, 14, 0, 0, 7, 18, 0, 16, 0, 0, 0, 0, 0, 26, 0, 16, 0, 0, 0
                    , 0, 0, 10, 0, 16, 0, 0, 0, 0, 0, 0, 0, 0, 8, 18, 0, 16, 0, 0, 0, 0, 0, 10
                    , 0, 16, 128, 65, 0, 0, 0, 0, 0, 0, 0, 42, 0, 16, 0, 0, 0, 0, 0, 164, 0, 0, 6
                    , 242, 224, 17, 0, 0, 0, 0, 0, 70, 10, 2, 0, 6, 0, 16, 0, 0, 0, 0, 0, 62, 0, 0
                    , 1, 83, 84, 65, 84, 148, 0, 0, 0, 26, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 1, 0
                    , 0, 0, 12, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 2, 0, 0, 0, 1, 0, 0, 0, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    , 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                    , 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, };
    }
}
